// prisma/schema.prisma
// Define your database models

generator client {
  provider   = "prisma-client-js"
  output     = "../src/generated"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
}

// model

enum ProductCategory {
  MOBILE
  LAPTOP
  WATCH
  OTHER
}

model Otp {
  id        String   @id @default(cuid())
  mobile    String
  code      String
  expiresAt DateTime
  used      Boolean  @default(false)
  attempts  Int      @default(0)
  createdAt DateTime @default(now())

  @@index([mobile])
}

model OtpSession {
  id        String   @id @default(cuid())
  mobile    String
  apiKey    String   @unique
  expiresAt DateTime
  createdAt DateTime @default(now())

  @@index([mobile])
}

model User {
  id        String    @id @default(cuid())
  userName  String
  email     String    @unique
  mobile    String
  password  String
  ban       Boolean   @default(false)
  role      UserRole  @default(user)
  avatarUrl String?
  addresses Address[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([mobile])
}

model Product {
  id          String          @id @default(uuid())
  name        String
  catagory    ProductCategory
  description String?
  price       Float?          @default(0.0)
  quantity    Int?            @default(0)
  image       Image[]
}

model Image {
  id        String   @id @default(uuid())
  image     String
  product   Product? @relation(fields: [productId], references: [id])
  productId String?
}

model Address {
  id       String @id @default(cuid())
  user     User   @relation(fields: [userId], references: [id])
  userId   String
  address  String
  city     String
  Province String
}

enum UserRole {
  user
  admin
}
